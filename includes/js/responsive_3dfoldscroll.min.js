(function(e){e.fn.responsive_3dfoldscroll=function(t){function i(e,t,n){this.element=e;this.i=t;this.hh=n}function s(){var s="";e.each(n,function(n,o){var u=e(o).find("img").height();s+='<div id="f-'+n+'" class="'+t.foldHolder+'" style="height:'+u+'px;">';if(u%2==1){s+='<div class="topHalf" style="height:'+(Math.floor(u/2)+1)+'px">'+e(o).html()+"</div>"}else{s+='<div class="topHalf" style="height:'+Math.floor(u/2)+'px">'+e(o).html()+"</div>"}s+='<div class="bottomHalf" style="height:'+Math.floor(u/2)+'px">'+e(o).html()+"</div>";s+="</div>";r[n]=new i(o,n,u)});e("#container").html(s);e("#page").height((r.length+.5)*t.animationLength);e("#footer-top").height(Math.floor(e(window).height()*.4));e("#footer-bottom").height(Math.ceil(e(window).height()*.6))}function u(){var n=e(window).scrollTop();var i=0;var s=0;e("#footer-top").height(Math.floor(e(window).height()*.4));e("#footer-bottom").height(Math.ceil(e(window).height()*.6));for(var o=0;o<r.length;o++){curpos=n;i=n;r[o].hh=e("#f-"+r[o].i).find("img").height();if(r[o].hh%2==1){e("#f-"+r[o].i+" .topHalf").css("height",Math.floor(r[o].hh/2)+1+"px")}else{e("#f-"+r[o].i+" .topHalf").css("height",Math.floor(r[o].hh/2)+"px")}e("#f-"+r[o].i+" .bottomHalf").css("height",Math.floor(r[o].hh/2)+"px");e("#page").height((r.length+.5)*t.animationLength);if(i<=t.animationLength*r[o].i){e("#f-"+r[o].i+" .topHalf").css("-webkit-transform","rotateX(0deg)");e("#f-"+r[o].i+" .topHalf").css("-moz-transform","rotateX(0deg)");e("#f-"+r[o].i+" .topHalf").css("transform","rotateX(0deg)");e("#f-"+r[o].i+" .bottomHalf").css("-webkit-transform","rotateX(0deg)");e("#f-"+r[o].i+" .bottomHalf").css("-moz-transform","rotateX(0deg)");e("#f-"+r[o].i+" .bottomHalf").css("transform","rotateX(0deg)");e("#f-"+r[o].i+".foldWrapper").css("height",""+r[o].hh+"px")}else{var u=1-(i-t.animationLength*r[o].i)/t.animationLength;if(u<0){u=0}var a=r[o].hh*u,f=b=r[o].hh/2,l=2*b*a,c=l<=0?90:Math.acos((b*b+a*a-f*f)/l)*180/Math.PI,h=360-c;e("#f-"+r[o].i+" .topHalf").css("-webkit-transform","rotateX("+h+"deg)");e("#f-"+r[o].i+" .bottomHalf").css("-webkit-transform","rotateX("+c+"deg)");var p=r[o].hh/1*u;e("#f-"+r[o].i+".foldWrapper").height(p)}}}t=e.extend({animationLength:1500,foldHolder:"foldWrapper"},t);var n=e("."+t.foldHolder);var r=[];s();var o;e(window).resize(function(){u()});var a=false;e(window).scroll(function(){var n,i,s;if(document.documentElement.scrollTop){i=document.documentElement.scrollTop}else{i=document.body.scrollTop}n=document.body.offsetHeight;s=document.documentElement.clientHeight;if(n<=i+s){if(!a){e("#footer-top").fadeIn();a=true}}else{if(a){e("#footer-top").fadeOut();a=false}}var o=e(window).scrollTop();var u=0;var f=0;for(var l=0;l<r.length;l++){curpos=o;u=o;if(u<=t.animationLength*r[l].i){e("#f-"+r[l].i+" .topHalf").css("-webkit-transform","rotateX(0deg)");e("#f-"+r[l].i+" .topHalf").css("-moz-transform","rotateX(0deg)");e("#f-"+r[l].i+" .topHalf").css("transform","rotateX(0deg)");e("#f-"+r[l].i+" .bottomHalf").css("-webkit-transform","rotateX(0deg)");e("#f-"+r[l].i+" .bottomHalf").css("-moz-transform","rotateX(0deg)");e("#f-"+r[l].i+" .bottomHalf").css("transform","rotateX(0deg)");e("#f-"+r[l].i+".foldWrapper").css("height",""+r[l].hh+"px")}else{var c=1-(u-t.animationLength*r[l].i)/t.animationLength;if(c<0){c=0}var h=r[l].hh*c,p=b=r[l].hh/2,d=2*b*h,v=d<=0?90:Math.acos((b*b+h*h-p*p)/d)*180/Math.PI,m=360-v;e("#f-"+r[l].i+" .topHalf").css("-webkit-transform","rotateX("+m+"deg)");e("#f-"+r[l].i+" .bottomHalf").css("-webkit-transform","rotateX("+v+"deg)");var g=r[l].hh/1*c;e("#f-"+r[l].i+".foldWrapper").height(g)}}})}})(jQuery)